<html>
<head>
<title>Whack</title>
<style>
#field {
    width: 800px;
    height: 425px;
    border: 1px solid black;
}
</style>
</head>

<body>

<canvas id="field" width="800" height="425"></canvas>
<br />
<button id="start">Start</button> <button id="pause">Pause</button>

<script src="field.js"></script>
<script src="scene.js"></script>
<script src="game.js"></script>
<script src="bullet.js"></script>
<script src="turret.js"></script>
<script src="critter.js"></script>
<script>

function random(min, max) {
	return  Math.floor(Math.random() * (max - min + 1)) + min;
}

document.addEventListener("DOMContentLoaded", function() {
	var canvas = document.getElementById("field");
	var ctx = canvas.getContext('2d');
	var field = new Field(800, 400, 50);
	var scene = new Scene(ctx);
	var game = new Game(field, scene);

	canvas.addEventListener("click", function(event) {
        var elemLeft = canvas.offsetLeft;
        var elemTop = canvas.offsetTop;
        var x = event.pageX - elemLeft;
        var y = event.pageY - elemTop;
		if (x <= 50) {
			return;
		}
        game.spawnTurret(x, y);
    });

	game.setup();
	game.draw();
	
	document.getElementById("start").addEventListener("click", function() {
		if (game.ended == 1) {
			return;
		}
		game.started = 1;
		game.running = requestAnimationFrame(function(t) {
			game.run(t);
		});
	});

	document.getElementById("pause").addEventListener("click", function() {
		if (game.started == 0 || game.ended == 1) {
			return;
		}
		if (game.running > 0) {
			cancelAnimationFrame(game.running);
			game.running = 0;
			document.getElementById("pause").innerHTML = "Unpause";
		}
		else {
			game.running = requestAnimationFrame(function(t) {
				game.run(t);
			});
			document.getElementById("pause").innerHTML = "Pause";
		}
	})

});

</script>
</body>
</html>